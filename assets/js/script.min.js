$(document).ready(function(){$("[data-bs-hover-animate]").mouseenter(function(){var e=$(this);e.addClass("animated "+e.attr("data-bs-hover-animate"))}).mouseleave(function(){var e=$(this);e.removeClass("animated "+e.attr("data-bs-hover-animate"))})});const fileSelector=document.getElementById("file-selector"),downloadMAL=document.getElementById("downloadMAL"),downloadDiv=document.getElementById("downloadDiv"),waiting=document.getElementById("waiting"),waiting1=document.getElementById("waiting-1"),timer=document.getElementById("timer"),timeout=2,errorTime=15,today=new Date,dd=String(today.getDate()).padStart(2,"0"),mm=String(today.getMonth()+1).padStart(2,"0"),yyyy=today.getFullYear(),dateToday=yyyy+"-"+mm+"-"+dd,convertFile=async e=>{const t=e.split("\n").map(e=>e.split("/")[4]),n=await getAnimeInfo(t),a=`<my_start_date>${dateToday}</my_start_date><my_finish_date>${dateToday}</my_finish_date>`,i=[],o=[];for(let e=0;e<t.length;e++){const s=t[e],r=`<anime>${`<series_animedb_id>${s}</series_animedb_id>`}${`<my_watched_episodes>${n[s].episodes}</my_watched_episodes>`}${a}${`<my_score>${Math.round(n[s].score)}</my_score>`}<my_status>Completed</my_status><update_on_import>1</update_on_import></anime>`;i.push(r),void 0===n[s]&&o.push(s)}const s=formatXml(`<?xml version='1.0' ?><myanimelist><myinfo><user_export_type>1</user_export_type></myinfo>${i.join("")}</myanimelist>`);returnFile(s),console.log("\nThe anime with the following ids were not found: "+o)},getFile=e=>{const t=e.target.files[0],n=new FileReader;n.onload=(e=>{const t=e.target.result;convertFile(t)}),n.onerror=(e=>reject(e)),n.readAsText(t)},returnFile=e=>{const t=document.createElement("a");t.setAttribute("href","data:application/xml;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("id","downloadFile"),t.download="MAL",t.style.display="none",downloadMAL.appendChild(t),makeVisible(downloadDiv)},pleaseWait=e=>{startTimer(2*e.length+15,timer),waiting.classList.toggle("invisible"),waiting1.classList.toggle("invisible")},getInfo=async e=>{const t=await fetch(`https://api.jikan.moe/v3/anime/${e}`),n=await t.json();return console.log(n.title),n};async function sleep(e){return new Promise(t=>setTimeout(t,e))}const getAnimeInfo=async e=>{pleaseWait(e);const t={};for(let n=0;n<e.length;n++){const a=e[n];await sleep(2e3),t[a]=await getInfo(a)}return t};function startTimer(e,t){var n,a,i=e;const o=setInterval(function(){n=parseInt(i/60,10),a=parseInt(i%60,10),n=n<10?"0"+n:n,a=a<10?"0"+a:a,t.textContent=n+":"+a,--i<0&&(clearInterval(o),waiting.classList.toggle("invisible"),waiting1.classList.toggle("invisible"))},1e3)}function formatXml(e){var t="";e=e.replace(/(>)(<)(\/*)/g,"$1\r\n$2$3");var n=0;return jQuery.each(e.split("\r\n"),function(e,a){var i=0;a.match(/.+<\/\w[^>]*>$/)?i=0:a.match(/^<\/\w/)?0!=n&&(n-=1):i=a.match(/^<\w[^>]*[^\/]>.*$/)?1:0;for(var o="",s=0;s<n;s++)o+="  ";t+=o+a+"\r\n",n+=i}),t}function makeVisible(e){e.classList.remove("invisible")}function startDownload(e){document.getElementById("downloadFile").click()}fileSelector.addEventListener("change",getFile),downloadMAL.addEventListener("click",startDownload);